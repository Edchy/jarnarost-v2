<div class="scroller" data-direction="left" data-speed="fast">
  <div class="scroller__inner">
    <h2>BRYGG.</h2>
    <img src="/images/coffee/brygg.avif" alt="bag of coffebeans" />
    <h2>ESP.</h2>
    <img src="/images/coffee/espgrande.avif" alt="bag of coffebeans" />
    <h2>BRYGG.</h2>
    <img src="/images/coffee/esp.avif" alt="bag of coffebeans" />
    <h2>ESP.</h2>
    <img src="/images/coffee/mellan.avif" alt="bag of coffebeans" />
  </div>
  <h3>DEMETER</h3>
  <!-- <img src="/images/logos/demeter.avif" alt="bag of coffebeans" /> -->
</div>

<style>
  .scroller {
    display: flex;
    align-items: center;
    max-width: 100vw;
    height: 40vh;
    overflow-x: clip;
    position: relative;
  }

  .scroller__inner {
    display: flex;
    align-items: center;
    gap: 1rem;
    position: absolute;
    right: 0;
    will-change: transform;
  }
  .scroller[data-animated="true"] .scroller__inner {
    width: max-content;
    flex-wrap: nowrap;
    animation: scroll var(--_animation-duration, 40s)
      var(--_animation-direction, forwards) linear infinite;
    animation-play-state: running; /* Ensure the animation runs by default */
  }

  .scroller[data-animated="true"] .scroller__inner:hover {
    animation-play-state: paused;
  }

  .scroller[data-direction="right"] {
    --_animation-direction: reverse;
  }

  .scroller[data-direction="left"] {
    --_animation-direction: forwards;
  }

  .scroller[data-animated="true"] .scroller__inner {
    animation: scroll 40s linear infinite;
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(50%);
    }
  }

  h2 {
    font-size: 6rem;
    white-space: nowrap;
    color: var(--color-1);
  }
  h3 {
    font-size: 6rem;
    color: rgba(255, 108, 2, 0.338);
    text-align: center;
    /* padding-left: 1rem; */
    margin: 0 auto;
  }
  @media (min-width: 700px) {
    h2,
    h3 {
      font-size: 10rem;
    }
  }

  .scroller__inner img {
    width: 300px;
    height: 300px;
    object-fit: contain;
    transform: rotate(90deg);
    transition: transform 0.3s ease;
    z-index: 999;
  }

  .scroller__inner img:hover {
    transform: rotate(0deg) translateY(100px) scale(1.25);
  }
</style>

<script>
  document.addEventListener("astro:page-load", () => {
    const scroller = document.querySelector(".scroller") as HTMLElement | null;

    function setupScroller() {
      if (!scroller) return;

      const scrollerInner = scroller.querySelector(
        ".scroller__inner"
      ) as HTMLElement | null;
      if (!scrollerInner) return;

      // Clone the content
      const scrollerContent = Array.from(
        scrollerInner.children
      ) as HTMLElement[];
      const scrollerContentWidth = scrollerContent.reduce((acc, item) => {
        return acc + item.offsetWidth;
      }, 0);

      // Clone enough times to fill the screen twice
      const numCopies = Math.ceil(
        (window.innerWidth * 2) / scrollerContentWidth
      );

      for (let i = 0; i < numCopies; i++) {
        scrollerContent.forEach((item) => {
          const duplicatedItem = item.cloneNode(true) as HTMLElement;
          duplicatedItem.setAttribute("aria-hidden", "true");
          scrollerInner.appendChild(duplicatedItem);
        });
      }

      scroller.setAttribute("data-animated", "true");
    }

    if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
      setupScroller();
    }
  });
</script>
